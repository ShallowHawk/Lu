# 🍎 iOS 快捷指令自动化配置指南

## 概述
通过iOS自带的"快捷指令"和"自动化"功能，实现iPhone端自动状态监控，无需安装第三方应用。

## 📱 基础设置

### 1. 启用快捷指令
- 打开iOS "设置" → "快捷指令"
- 开启 "允许不受信任的快捷指令"（如果有该选项）

### 2. 获取服务器地址
将 `YOUR_SERVER_IP` 替换为您的实际服务器IP地址
```
示例: http://192.168.1.100:5000
```

## 🎯 核心快捷指令创建

### 📲 基础状态更新快捷指令

#### 1. 创建通用状态更新器
1. 打开"快捷指令"App
2. 点击右上角"+"创建新快捷指令
3. 添加以下动作：

**动作1: 获取URL内容**
```
URL: http://YOUR_SERVER_IP:5000/set
方法: GET
参数: 
  - secret: birthday2024
  - status: [状态ID变量]
```

**动作2: 显示通知**（可选）
```
标题: 状态已更新
内容: 林璐现在[状态名称]
```

#### 2. 创建具体状态快捷指令

##### 睡觉状态
- 快捷指令名称: "设置睡觉状态"
- URL: `http://YOUR_SERVER_IP:5000/set?secret=birthday2024&status=1`

##### 工作状态  
- 快捷指令名称: "设置工作状态"
- URL: `http://YOUR_SERVER_IP:5000/set?secret=birthday2024&status=2`

##### 运动状态
- 快捷指令名称: "设置运动状态"  
- URL: `http://YOUR_SERVER_IP:5000/set?secret=birthday2024&status=3`

##### 看B站状态
- 快捷指令名称: "设置看B站状态"
- URL: `http://YOUR_SERVER_IP:5000/set?secret=birthday2024&status=4`

##### 玩游戏状态
- 快捷指令名称: "设置游戏状态"
- URL: `http://YOUR_SERVER_IP:5000/set?secret=birthday2024&status=5`

##### 听音乐状态
- 快捷指令名称: "设置音乐状态"
- URL: `http://YOUR_SERVER_IP:5000/set?secret=birthday2024&status=6`

##### 学习状态
- 快捷指令名称: "设置学习状态"
- URL: `http://YOUR_SERVER_IP:5000/set?secret=birthday2024&status=7`

##### 做饭状态
- 快捷指令名称: "设置做饭状态"
- URL: `http://YOUR_SERVER_IP:5000/set?secret=birthday2024&status=8`

## 🤖 自动化规则配置

### ⏰ 时间触发自动化

#### 1. 睡眠时间自动化
1. 打开"快捷指令"App → "自动化"标签
2. 点击"+"创建个人自动化
3. 选择"特定时间"
4. 设置时间为 22:00，重复选择"每天"
5. 点击"下一步"，选择"运行快捷指令"
6. 选择之前创建的"设置睡觉状态"快捷指令
7. 关闭"运行前询问"

#### 2. 起床时间自动化
- 触发器: 特定时间 07:00
- 动作: 运行"设置工作状态"快捷指令

#### 3. 工作开始自动化
- 触发器: 特定时间 09:00（仅工作日）
- 动作: 运行"设置工作状态"快捷指令

### 📱 应用启动触发

#### 1. B站应用自动化
1. 创建个人自动化
2. 选择"App"触发器
3. 选择"哔哩哔哩"应用
4. 选择"App已打开"
5. 运行"设置看B站状态"快捷指令

#### 2. 游戏应用自动化
- 触发器: 游戏App已打开（王者荣耀、原神等）
- 动作: 运行"设置游戏状态"快捷指令

#### 3. 音乐应用自动化
- 触发器: 音乐App已打开（网易云音乐、Apple Music等）
- 动作: 运行"设置音乐状态"快捷指令

#### 4. 学习应用自动化
- 触发器: 学习类App已打开（有道词典、微信读书等）
- 动作: 运行"设置学习状态"快捷指令

### 🎵 媒体播放触发

#### 音乐播放自动化
1. 创建个人自动化
2. 选择"播放媒体"触发器
3. 选择"音乐"媒体类型
4. 运行"设置音乐状态"快捷指令

### 🔋 设备状态触发

#### 1. 充电开始自动化
1. 创建个人自动化
2. 选择"充电器"触发器
3. 选择"已连接"
4. 添加条件：时间在 22:00-06:00 之间
5. 运行"设置睡觉状态"快捷指令

#### 2. CarPlay连接自动化
1. 触发器: CarPlay已连接
2. 动作: 运行"设置工作状态"快捷指令（通勤）

### 📍 位置触发

#### 1. 到家自动化
1. 创建个人自动化
2. 选择"到达"触发器
3. 设置家庭位置
4. 运行"设置睡觉状态"快捷指令（如果是晚上）

#### 2. 离开家自动化
1. 触发器: 离开家庭位置
2. 动作: 运行"设置工作状态"快捷指令

#### 3. 健身房自动化
1. 触发器: 到达健身房位置
2. 动作: 运行"设置运动状态"快捷指令

### 🏃‍♀️ 健康数据触发

#### 体能训练自动化
1. 创建个人自动化
2. 选择"体能训练"触发器
3. 选择"体能训练开始时"
4. 运行"设置运动状态"快捷指令

## 🎨 进阶自动化

### 智能状态切换

#### 智能睡眠检测
创建复合自动化：
1. **低功耗模式开启** + **夜间时段** → 睡觉状态
2. **勿扰模式开启** + **充电中** → 睡觉状态

#### 工作状态判断
```
条件组合:
- 时间: 工作日 9:00-18:00
- 位置: 不在家
- 网络: 连接公司WiFi
→ 自动设置工作状态
```

### 状态优先级处理

#### 手动优先级快捷指令
创建一个带菜单的快捷指令：
```
1. 添加"从菜单中选取"动作
2. 选项包含所有状态
3. 根据选择发送对应的HTTP请求
4. 添加到主屏幕或控制中心
```

#### Siri语音控制
为每个状态快捷指令录制Siri短语：
- "我要睡觉了" → 设置睡觉状态
- "我在工作" → 设置工作状态  
- "我在运动" → 设置运动状态

## 📋 自动化规则列表

| 触发器类型 | 触发条件 | 目标状态 | 备注 |
|-----------|---------|---------|------|
| 时间 | 22:00 每天 | 睡觉中 | 夜间模式 |
| 时间 | 07:00 每天 | 工作中 | 晨起默认 |
| 时间 | 09:00 工作日 | 工作中 | 工作开始 |
| App启动 | B站、抖音 | 看B站 | 娱乐应用 |
| App启动 | 游戏类 | 玩游戏 | 游戏应用 |
| App启动 | 音乐类 | 听音乐 | 音乐应用 |
| App启动 | 学习类 | 学习中 | 学习应用 |
| 媒体播放 | 音乐播放 | 听音乐 | 后台播放 |
| 充电 | 夜间充电 | 睡觉中 | 夜间+充电 |
| 位置 | 到达家 | 睡觉中/工作中 | 依时间判断 |
| 位置 | 健身房 | 运动中 | 位置触发 |
| 体能训练 | 开始训练 | 运动中 | 健康触发 |

## 🛠️ 高级功能

### 条件判断快捷指令
```
如果 当前时间 > 22:00
  设置睡觉状态
否则如果 当前时间 < 07:00  
  设置睡觉状态
否则
  设置工作状态
```

### 网络状态检查
```
获取网络详情
如果 WiFi已连接
  继续执行状态更新
否则
  显示"网络未连接"通知
```

### 批量状态控制
创建一个状态管理中心：
```
1. 从菜单中选取当前活动
2. 根据选择设置对应状态
3. 发送通知确认
4. 记录到备忘录（可选）
```

## 🚨 注意事项

1. **权限设置**: 
   - 允许快捷指令运行时不询问
   - 授予位置、健康数据等必要权限

2. **网络要求**: 
   - 确保iPhone能访问服务器IP
   - 建议使用家庭WiFi网络

3. **隐私保护**: 
   - 避免在不安全网络下运行
   - 考虑使用VPN保护通信

4. **电池优化**: 
   - 过多自动化可能影响电池续航
   - 建议只启用必要的自动化规则

5. **iOS版本**: 
   - iOS 13+ 支持个人自动化
   - iOS 14+ 支持更多触发器类型

## 📱 快速导入模板

### 一键导入快捷指令
扫描二维码或点击链接导入预配置的快捷指令：

```
状态控制中心: [快捷指令链接]
睡眠自动化: [快捷指令链接]  
工作自动化: [快捷指令链接]
娱乐自动化: [快捷指令链接]
```

*注：实际使用时需要修改服务器IP地址*

## 🔄 同步其他设备

### 跨设备状态同步
- iCloud同步快捷指令
- 多台iOS设备共享自动化规则
- 与Mac端快捷指令联动

---

**🎉 配置完成后，您的iPhone就能智能地自动更新状态了！** 
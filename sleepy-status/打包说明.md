# 状态监控程序打包说明

## 概述
本文档介绍如何将Python状态监控程序打包成Windows可执行文件，让没有Python基础的用户可以直接双击运行。

## 提供的文件

### 主程序文件
- `auto_monitor.py` - 原始的控制台版本监控程序
- `status_monitor_gui.py` - GUI版本监控程序
- `start_gui.py` - GUI版本启动脚本

### 构建工具
- `build_exe.py` - 程序构建脚本
- `构建程序.bat` - 构建工具启动脚本
- `启动GUI版本.bat` - 直接启动GUI版本的批处理文件

## 使用方法

### 方法一：直接运行（需要Python环境）
如果用户有Python环境，可以直接运行：

**GUI版本（推荐）**：
1. 双击 `启动GUI版本.bat`
2. 程序会自动检查依赖并启动GUI界面

**控制台版本**：
1. 双击 `start_monitor.bat`
2. 按照提示选择用户

### 方法二：构建可执行文件（推荐用于分发）
如果要分发给没有Python环境的用户：

1. **启动构建工具**：
   - 双击 `构建程序.bat`
   - 或者在命令行运行：`python build_exe.py`

2. **选择构建选项**：
   - `[1] 构建GUI版本` - 构建图形界面版本
   - `[2] 构建控制台版本` - 构建控制台版本
   - `[3] 构建全部版本` - 构建所有版本
   - `[4] 创建便携包` - 创建包含说明文档的便携包
   - `[5] 全部执行` - 构建所有版本并创建便携包

3. **构建完成后**：
   - 可执行文件会生成在 `dist/` 目录中
   - 便携包会生成在 `状态监控程序_便携版/` 目录中

## 生成的文件

### 可执行文件
- `状态监控程序_GUI.exe` - 图形界面版本
- `状态监控程序_控制台.exe` - 控制台版本

### 便携包内容
- 可执行文件
- `使用说明.txt` - 详细的使用说明

## 技术说明

### 构建工具
使用 **PyInstaller** 将Python脚本打包成可执行文件：
- `--onefile` - 打包成单个文件
- `--windowed` - GUI版本不显示控制台窗口
- `--console` - 控制台版本显示控制台窗口

### 依赖处理
程序会自动处理以下依赖：
- Flask (用于API通信)
- requests (用于HTTP请求)
- psutil (用于系统信息)
- pywin32 (用于Windows API)

### 系统要求
- Windows 10 或更高版本
- Python 3.7 或更高版本（仅构建时需要）
- 网络连接（用于状态上传）

## 用户分发

### 给有Python环境的用户
直接提供整个项目文件夹，用户可以：
1. 双击 `启动GUI版本.bat` 运行GUI版本
2. 双击 `start_monitor.bat` 运行控制台版本

### 给没有Python环境的用户
提供便携包 `状态监控程序_便携版/`，用户可以：
1. 双击 `状态监控程序_GUI.exe` 运行GUI版本（推荐）
2. 双击 `状态监控程序_控制台.exe` 运行控制台版本

## 故障排除

### 构建失败
1. 确保已安装Python 3.7+
2. 运行 `pip install -r requirements.txt` 安装依赖
3. 运行 `pip install pyinstaller` 安装打包工具

### 可执行文件运行失败
1. 检查Windows版本兼容性
2. 确保网络连接正常
3. 检查防火墙设置
4. 以管理员身份运行

### 杀毒软件误报
某些杀毒软件可能会误报PyInstaller生成的可执行文件：
1. 将程序添加到白名单
2. 临时关闭实时保护
3. 使用 `--debug` 选项重新构建

## 自定义配置

### 修改服务器地址
在GUI版本中，用户可以直接修改服务器配置。
在控制台版本中，需要修改 `auto_monitor.py` 中的默认配置。

### 添加新的应用程序支持
修改 `auto_monitor.py` 中的 `app_status_map` 字典，添加新的应用程序映射。

## 更新程序
如果需要更新程序：
1. 修改源代码
2. 重新运行构建脚本
3. 分发新的可执行文件

## 注意事项
- 生成的可执行文件较大（约50-100MB），因为包含了Python运行时
- 首次启动可能较慢，后续启动会更快
- 程序需要网络权限才能正常工作
- 建议在分发前进行充分测试 
# å®å¡”é¢æ¿éƒ¨ç½²æŒ‡å— ğŸš€

## ğŸ“‹ éƒ¨ç½²æ¦‚è§ˆ

æ‚¨çš„é¡¹ç›®åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼š
- **å‰ç«¯ (birthday-website)**: Nuxt.jsç½‘ç«™ï¼Œéœ€è¦æ„å»ºæˆé™æ€æ–‡ä»¶
- **åç«¯ (sleepy-status)**: Flask APIæœåŠ¡ï¼Œæä¾›æ•°æ®æ¥å£
- **æœ¬åœ°ç›‘æ§ (auto_monitor.py)**: åœ¨æ‚¨çš„æœ¬åœ°ç”µè„‘è¿è¡Œï¼Œç›‘æ§çŠ¶æ€

## ğŸ  ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡å·¥ä½œ

### 1. æ£€æŸ¥å®å¡”é¢æ¿ç¯å¢ƒ
åœ¨å®å¡”é¢æ¿ä¸­ç¡®è®¤å·²å®‰è£…ï¼š
- **Nginx** (ç”¨äºç½‘ç«™æœåŠ¡)
- **Python 3.8+** (ç”¨äºåç«¯API)
- **Node.js 18+** (ç”¨äºå‰ç«¯æ„å»º)
- **PM2** (ç”¨äºè¿›ç¨‹ç®¡ç†ï¼Œå¯é€‰)

### 2. åˆ›å»ºç½‘ç«™ç›®å½•
åœ¨å®å¡”é¢æ¿ä¸­ï¼š
1. ç‚¹å‡» "ç½‘ç«™" â†’ "æ·»åŠ ç«™ç‚¹"
2. è¾“å…¥æ‚¨çš„åŸŸåï¼ˆæˆ–ä½¿ç”¨IPåœ°å€ï¼‰
3. åˆ›å»ºæ•°æ®åº“ï¼ˆå¯é€‰ï¼Œå½“å‰é¡¹ç›®ä½¿ç”¨JSONæ–‡ä»¶ï¼‰

## ğŸ¯ ç¬¬äºŒæ­¥ï¼šéƒ¨ç½²åç«¯APIæœåŠ¡

### 1. ä¸Šä¼ åç«¯æ–‡ä»¶
å°† `sleepy-status` æ–‡ä»¶å¤¹ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼š
```bash
# å»ºè®®è·¯å¾„ï¼š/www/wwwroot/your-domain/api/
/www/wwwroot/your-domain/
â”œâ”€â”€ api/                    # sleepy-statusæ–‡ä»¶å¤¹é‡å‘½åä¸ºapi
â”‚   â”œâ”€â”€ app.py
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”œâ”€â”€ data.json
â”‚   â””â”€â”€ ...
â””â”€â”€ dist/                   # å‰ç«¯æ„å»ºæ–‡ä»¶(ç¨ååˆ›å»º)
```

### 2. å®‰è£…Pythonä¾èµ–
åœ¨å®å¡”é¢æ¿çš„ç»ˆç«¯ä¸­ï¼š
```bash
cd /www/wwwroot/your-domain/api
pip install -r requirements.txt
```

### 3. ä¿®æ”¹Flaské…ç½®
ç¼–è¾‘ `app.py` æ–‡ä»¶ï¼Œæ‰¾åˆ°æœ€åå‡ è¡Œï¼š
```python
if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5000, debug=False)  # æ”¹ä¸ºFalse
```

### 4. åˆ›å»ºPythonåº”ç”¨
åœ¨å®å¡”é¢æ¿ä¸­ï¼š
1. ç‚¹å‡» "Pythoné¡¹ç›®" â†’ "æ·»åŠ Pythoné¡¹ç›®"
2. é¡¹ç›®åç§°ï¼š`birthday-api`
3. è·¯å¾„ï¼š`/www/wwwroot/your-domain/api`
4. å¯åŠ¨æ–‡ä»¶ï¼š`app.py`
5. ç«¯å£ï¼š`5000`
6. ç‚¹å‡»"æäº¤"

### 5. é…ç½®åå‘ä»£ç†
åœ¨å®å¡”é¢æ¿çš„ç½‘ç«™è®¾ç½®ä¸­ï¼š
1. ç‚¹å‡»æ‚¨çš„ç½‘ç«™ â†’ "åå‘ä»£ç†"
2. æ·»åŠ åå‘ä»£ç†ï¼š
   - ä»£ç†åç§°ï¼š`api`
   - ç›®æ ‡URLï¼š`http://127.0.0.1:5000`
   - å‘é€åŸŸåï¼š`127.0.0.1`
   - ä»£ç†ç›®å½•ï¼š`/api`

## ğŸŒ ç¬¬ä¸‰æ­¥ï¼šéƒ¨ç½²å‰ç«¯ç½‘ç«™

### 1. åœ¨æœ¬åœ°æ„å»ºå‰ç«¯
åœ¨æ‚¨çš„æœ¬åœ°ç”µè„‘ä¸Šï¼š
```bash
cd D:\LinLu\birthday-website

# å®‰è£…ä¾èµ–
npm install

# ç”Ÿæˆé™æ€æ–‡ä»¶
npm run generate
```

### 2. ä¿®æ”¹å‰ç«¯APIé…ç½®
åˆ›å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶æ¥æŒ‡å‘æ‚¨çš„æœåŠ¡å™¨APIï¼š

```javascript
// birthday-website/composables/useApi.js
export const useApi = () => {
  const config = useRuntimeConfig()
  const baseURL = process.client 
    ? 'https://your-domain.com/api'  // æ›¿æ¢ä¸ºæ‚¨çš„åŸŸå
    : 'http://localhost:5000'

  const $fetch = $fetch.create({
    baseURL
  })

  return {
    $fetch,
    baseURL
  }
}
```

### 3. ä¸Šä¼ å‰ç«¯æ–‡ä»¶
å°† `birthday-website/.output/public` æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰æ–‡ä»¶ä¸Šä¼ åˆ°ï¼š
```bash
/www/wwwroot/your-domain/
```

### 4. é…ç½®Nginx
åœ¨å®å¡”é¢æ¿ä¸­ï¼Œç¼–è¾‘ç½‘ç«™çš„Nginxé…ç½®ï¼š
```nginx
location / {
    try_files $uri $uri/ /index.html;
    
    # ç¼“å­˜é™æ€èµ„æº
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
        expires 1y;
        add_header Cache-Control "public, no-transform";
    }
}

location /api/ {
    proxy_pass http://127.0.0.1:5000/;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
}
```

## ğŸ–¥ï¸ ç¬¬å››æ­¥ï¼šæœ¬åœ°ç›‘æ§è®¾ç½®

### 1. ä¿®æ”¹æœ¬åœ°ç›‘æ§é…ç½®
åœ¨æ‚¨çš„æœ¬åœ°ç”µè„‘ä¸Šç¼–è¾‘ `auto_monitor.py`ï¼Œç¡®ä¿APIåœ°å€æŒ‡å‘æ‚¨çš„æœåŠ¡å™¨ï¼š

```python
# åœ¨æ–‡ä»¶é¡¶éƒ¨ä¿®æ”¹APIåœ°å€
API_URL = 'https://your-domain.com/api'  # æ›¿æ¢ä¸ºæ‚¨çš„åŸŸå
```

### 2. è¿è¡Œæœ¬åœ°ç›‘æ§
åœ¨æ‚¨çš„æœ¬åœ°ç”µè„‘ä¸Šï¼š
```bash
cd D:\LinLu\sleepy-status
python auto_monitor.py
```

### 3. è®¾ç½®å¼€æœºè‡ªå¯ï¼ˆå¯é€‰ï¼‰
åˆ›å»ºä¸€ä¸ªæ‰¹å¤„ç†æ–‡ä»¶ `start_monitor.bat`ï¼š
```batch
@echo off
cd /d "D:\LinLu\sleepy-status"
python auto_monitor.py
pause
```

## ğŸ§ª ç¬¬äº”æ­¥ï¼šæµ‹è¯•éƒ¨ç½²

### 1. æµ‹è¯•åç«¯API
è®¿é—®ï¼š`https://your-domain.com/api/status`
åº”è¯¥è¿”å›JSONæ•°æ®

### 2. æµ‹è¯•å‰ç«¯ç½‘ç«™
è®¿é—®ï¼š`https://your-domain.com`
åº”è¯¥çœ‹åˆ°ç”Ÿæ—¥ç½‘ç«™

### 3. æµ‹è¯•çŠ¶æ€åŒæ­¥
1. åœ¨æœ¬åœ°è¿è¡Œ `auto_monitor.py`
2. æ‰“å¼€ä¸€äº›åº”ç”¨ç¨‹åº
3. åœ¨ç½‘ç«™ä¸ŠæŸ¥çœ‹çŠ¶æ€æ˜¯å¦æ›´æ–°

## ğŸ”’ ç¬¬å…­æ­¥ï¼šå®‰å…¨é…ç½®

### 1. é…ç½®SSLè¯ä¹¦
åœ¨å®å¡”é¢æ¿ä¸­ï¼š
1. ç‚¹å‡»æ‚¨çš„ç½‘ç«™ â†’ "SSL"
2. é€‰æ‹©"Let's Encrypt"å…è´¹è¯ä¹¦
3. ç‚¹å‡»"ç”³è¯·"

### 2. é…ç½®é˜²ç«å¢™
ç¡®ä¿ä»¥ä¸‹ç«¯å£å¼€æ”¾ï¼š
- 80 (HTTP)
- 443 (HTTPS)
- 5000 (APIç«¯å£ï¼Œä»…å†…éƒ¨è®¿é—®)

## ğŸ› ï¸ å¸¸è§é—®é¢˜è§£å†³

### 1. Pythonä¾èµ–å®‰è£…å¤±è´¥
```bash
# ä½¿ç”¨é•œåƒæº
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple/
```

### 2. å‰ç«¯æ„å»ºå¤±è´¥
```bash
# æ¸…é™¤ç¼“å­˜åé‡è¯•
npm cache clean --force
rm -rf node_modules package-lock.json
npm install
```

### 3. APIè·¨åŸŸé—®é¢˜
ç¡®ä¿Flaskåº”ç”¨ä¸­æœ‰CORSé…ç½®ï¼š
```python
from flask_cors import CORS
app = Flask(__name__)
CORS(app)
```

### 4. çŠ¶æ€ä¸æ›´æ–°
æ£€æŸ¥ï¼š
- æœ¬åœ° `auto_monitor.py` æ˜¯å¦åœ¨è¿è¡Œ
- APIåœ°å€æ˜¯å¦æ­£ç¡®é…ç½®
- ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸

## ğŸ“ éƒ¨ç½²æ£€æŸ¥æ¸…å•

- [ ] å®å¡”é¢æ¿ç¯å¢ƒå‡†å¤‡å®Œæˆ
- [ ] åç«¯APIæœåŠ¡å¯åŠ¨æ­£å¸¸
- [ ] å‰ç«¯ç½‘ç«™æ„å»ºå¹¶ä¸Šä¼ 
- [ ] Nginxé…ç½®æ­£ç¡®
- [ ] SSLè¯ä¹¦é…ç½®ï¼ˆå¯é€‰ï¼‰
- [ ] æœ¬åœ°ç›‘æ§ç¨‹åºè¿è¡Œ
- [ ] æ•´ä½“åŠŸèƒ½æµ‹è¯•é€šè¿‡

## ğŸ‰ å®Œæˆï¼

ç°åœ¨æ‚¨çš„ç”Ÿæ—¥ç½‘ç«™åº”è¯¥å¯ä»¥æ­£å¸¸è®¿é—®äº†ï¼

- ç½‘ç«™åœ°å€ï¼š`https://your-domain.com`
- APIæ¥å£ï¼š`https://your-domain.com/api`
- çŠ¶æ€ç›‘æ§ï¼šæœ¬åœ°è¿è¡Œ `auto_monitor.py`

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥å®å¡”é¢æ¿çš„æ—¥å¿—æ–‡ä»¶æˆ–è”ç³»æŠ€æœ¯æ”¯æŒã€‚ 